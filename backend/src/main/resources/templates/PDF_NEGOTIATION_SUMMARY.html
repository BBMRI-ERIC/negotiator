<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>Negotiation Summary Report</title>
    <style type="text/css">
        @page {
            size: A4;
            margin: 2.5cm 2cm 3cm 2cm;
            @bottom-right {
                content: "Page " counter(page);
                font-family: Arial, sans-serif;
                font-size: 10px;
                color: #666;
            }
            @top-right {
                content: "";
                background: url('data:image/svg+xml;base64,') no-repeat;
                background-size: 60px 30px;
                width: 60px;
                height: 30px;
            }
        }

        @page :first {
            @bottom-right { content: none; }
            @top-right { content: none; }
        }

        body {
            font-family: Arial, sans-serif;
            font-size: 11px;
            line-height: 1.6;
            color: #2c3e50;
            margin: 0;
            padding: 0;
        }

        .cover-page {
            text-align: center;
            background-color: #f8f9fa;
            border: 2px solid #003366;
            padding: 2em;
            margin-bottom: 2em;
            page-break-after: always;
        }

        .cover-logo img {
            width: 180px;
            height: auto;
        }

        .cover-logo {
            margin: 1em 0;
            text-align: center;
            height: auto;
            overflow: visible;
            display: block;
        }

        .page-logo {
            position: fixed;
            top: 1cm;
            right: 1cm;
            width: 60px;
            height: 30px;
            z-index: 1000;
        }

        .page-logo img {
            max-width: 60px;
            max-height: 30px;
            width: auto;
            height: auto;
        }

        .cover-title {
            color: #003366;
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 1em;
        }

        .cover-subtitle {
            color: #6c757d;
            font-size: 16px;
            margin-bottom: 2em;
        }

        .cover-details {
            background-color: white;
            padding: 1.5em;
            border: 1px solid #dee2e6;
            text-align: left;
        }

        .detail-row {
            padding: 0.5em 0;
            border-bottom: 1px solid #dee2e6;
        }

        .detail-label {
            font-weight: bold;
            color: #003366;
            display: inline-block;
            width: 40%;
        }

        .detail-value {
            color: #2c3e50;
            display: inline-block;
        }

        h1 {
            color: #003366;
            font-size: 20px;
            font-weight: bold;
            margin: 2em 0 1em 0;
            page-break-after: avoid;
        }

        h2 {
            color: white;
            font-size: 16px;
            font-weight: bold;
            margin: 2em 0 1em 0;
            padding: 0.75em;
            background-color: #003366;
            page-break-after: avoid;
        }

        .section {
            margin-bottom: 2em;
            padding: 1em;
            border: 1px solid #e8ecef;
            page-break-inside: avoid;
        }

        .summary-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 1em;
        }

        .summary-table td {
            padding: 0.75em;
            border-bottom: 1px solid #e8ecef;
            vertical-align: top;
        }

        .summary-table .label-col {
            font-weight: bold;
            color: #003366;
            width: 30%;
            background-color: #f0f6ff;
        }

        .summary-table .value-col {
            color: #2c3e50;
        }

        .field-container {
            margin-bottom: 1em;
            padding: 0.75em;
            background-color: #f8f9fa;
            border-left: 3px solid #003366;
        }

        .field-label {
            font-weight: bold;
            color: #003366;
            font-size: 10px;
            text-transform: uppercase;
            display: block;
            margin-bottom: 0.5em;
        }

        .field-value {
            color: #2c3e50;
        }

        .nested-container {
            margin-left: 1em;
            margin-top: 0.5em;
            padding-left: 1em;
            border-left: 2px solid #dee2e6;
        }

        .status-badge {
            display: inline-block;
            padding: 0.3em 0.6em;
            font-size: 10px;
            font-weight: bold;
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .placeholder-box {
            border: 2px dashed #dee2e6;
            background-color: #f8f9fa;
            padding: 1.5em;
            text-align: center;
            color: #6c757d;
            font-style: italic;
        }

        .page-break {
            page-break-before: always;
        }

        .legal-footer {
            margin-top: 3em;
            padding: 1.5em;
            background-color: #f8f9fa;
            border-top: 3px solid #003366;
            font-size: 9px;
            line-height: 1.4;
        }

        .contact-section {
            margin-top: 1em;
        }

        .contact-column {
            display: inline-block;
            width: 30%;
            vertical-align: top;
            margin-right: 3%;
        }

        .contact-header {
            font-weight: bold;
            color: #003366;
            font-size: 10px;
            margin-bottom: 0.5em;
        }

        .text-muted {
            color: #6c757d;
        }

        .font-bold {
            font-weight: bold;
        }
    </style>
</head>
<body>

<!-- COVER PAGE -->
<div class="cover-page">
    <div class="cover-logo">
        <div th:insert="~{LOGO}"></div>
    </div>

    <h1 class="cover-title">Negotiation Summary Report</h1>
    <p class="cover-subtitle">Biobanking Resource Request Documentation</p>

    <div class="cover-details">
        <div class="detail-row">
            <span class="detail-label">Negotiation ID:</span>
            <span class="detail-value" th:text="${negotiationId}">Not specified</span>
        </div>
        <div class="detail-row">
            <span class="detail-label">Requester:</span>
            <span class="detail-value" th:text="${authorName}">Not specified</span>
        </div>
        <div class="detail-row">
            <span class="detail-label">Institution:</span>
            <span class="detail-value" th:text="${authorInstitution ?: 'Not Specified'}">Not specified</span>
        </div>
        <div class="detail-row">
            <span class="detail-label">Submitted:</span>
            <span class="detail-value" th:text="${negotiationCreatedAt}">Not specified</span>
        </div>
        <div class="detail-row">
            <span class="detail-label">Status:</span>
            <span class="detail-value">
                <span class="status-badge" th:text="${negotiationStatus}">Not specified</span>
            </span>
        </div>
        <div class="detail-row">
            <span class="detail-label">Report Generated:</span>
            <span class="detail-value" th:text="${now}">Not specified</span>
        </div>
    </div>
</div>

<!-- REQUEST OVERVIEW -->
<div class="page-break"></div>
<h1>Request Overview</h1>

<div class="section">
    <table class="summary-table">
        <tr>
            <td class="label-col">Requester Name:</td>
            <td class="value-col" th:text="${authorName}">Not specified</td>
        </tr>
        <tr>
            <td class="label-col">Email Address:</td>
            <td class="value-col" th:text="${authorEmail}">Not specified</td>
        </tr>
        <tr>
            <td class="label-col">Institution:</td>
            <td class="value-col" th:text="${authorInstitution ?: 'Not Specified'}">Not specified</td>
        </tr>
        <tr>
            <td class="label-col">Negotiation ID:</td>
            <td class="value-col font-bold" th:text="${negotiationId}">Not specified</td>
        </tr>
        <tr>
            <td class="label-col">Project Title:</td>
            <td class="value-col" th:text="${negotiationTitle ?: 'Not Specified'}">Not specified</td>
        </tr>
        <tr>
            <td class="label-col">Submission Date:</td>
            <td class="value-col" th:text="${negotiationCreatedAt}">Not specified</td>
        </tr>
        <tr>
            <td class="label-col">Current Status:</td>
            <td class="value-col">
                <span class="status-badge" th:text="${negotiationStatus}">Not specified</span>
            </td>
        </tr>
        <tr>
            <td class="label-col">Report Generated:</td>
            <td class="value-col text-muted" th:text="${now}">Not specified</td>
        </tr>
    </table>
</div>

<!-- DETAILED REQUEST SECTIONS -->
<div th:each="section, iterStat : ${negotiationPayload}">
    <div class="page-break" th:if="${iterStat.index > 0}"></div>
    <h2 th:text="${section.key}">Request Details</h2>
    <div class="section">
        <div class="field-container" th:each="entry : ${section.value}">
            <span class="field-label" th:text="${entry.key}">Field Name</span>
            <div class="field-value">
                <span th:if="${entry.value instanceof T(java.util.List)}"
                      th:text="${#strings.arrayJoin(entry.value, ', ')}">value1, value2, value3</span>

                <div th:if="${entry.value instanceof T(java.util.Map)}" class="nested-container">
                    <div class="field-container" th:each="subEntry : ${entry.value}">
                        <span class="field-label" th:text="${subEntry.key}">Subfield Name</span>
                        <div class="field-value">
                            <span th:if="${subEntry.value instanceof T(java.util.Map)}" th:text="'[Complex Object]'">[Complex Object]</span>
                            <span th:if="${subEntry.value instanceof T(java.util.List)}" th:text="${#strings.arrayJoin(subEntry.value, ', ')}">item1, item2, item3</span>
                            <span th:if="${!(subEntry.value instanceof T(java.util.List)) and !(subEntry.value instanceof T(java.util.Map))}" th:utext="${subEntry.value}">Simple value content</span>
                        </div>
                    </div>
                </div>

                <span th:if="${!(entry.value instanceof T(java.util.List)) and !(entry.value instanceof T(java.util.Map))}"
                      th:utext="${entry.value}">Simple field value</span>
            </div>
        </div>
    </div>
</div>

<div class="page-break"></div>

<!-- LEGAL DISCLAIMER AND FOOTER -->
<div class="legal-footer">
    <h2 style="color: #003366; font-size: 12px; margin-top: 0; margin-bottom: 1em;">Legal Disclaimer and Contact Information</h2>

    <p><strong>Confidentiality Notice:</strong> This document contains confidential and proprietary information. It is intended solely for the use of the named recipient(s) and may not be distributed, reproduced, or disclosed without prior written consent from BBMRI-ERIC.</p>

    <p><strong>Data Protection:</strong> This negotiation summary is processed in accordance with applicable data protection regulations, including the General Data Protection Regulation (GDPR). Personal data is handled in accordance with BBMRI-ERIC's Privacy Policy.</p>

    <p><strong>Limitation of Liability:</strong> The information in this document is provided "as is" without warranty of any kind. BBMRI-ERIC shall not be liable for any damages arising from the use of this information.</p>

    <div class="contact-section">
        <div class="contact-column">
            <div class="contact-header">BBMRI-ERIC Headquarters</div>
            <p>
                Neue Stiftingtalstraße 2/B/6<br />
                8010 Graz, Austria<br />
                <strong>Phone:</strong> +433163499170 <br />
                <strong>Email:</strong> contact@bbmri-eric.eu
            </p>
        </div>

        <div class="contact-column">
            <div class="contact-header">Technical Support</div>
            <p>
                <strong>Negotiator Platform:</strong><br />
                Email: negotiator@helpdesk.bbmri-eric.eu<br />
                <strong>Service Desk:</strong><br />
                Web: https://www.bbmri-eric.eu<br />
                Hours: Mon-Fri, 9:00-17:00 CET
            </p>
        </div>

        <div class="contact-column">
            <div class="contact-header">Legal and Compliance</div>
            <p>
                <strong>Data Protection Officer:</strong><br />
                Email: dpo@bbmri-eric.eu<br />
                <strong>Legal Affairs:</strong><br />
                Email: legal@bbmri-eric.eu<br />
                Web: https://www.bbmri-eric.eu/legal
            </p>
        </div>
    </div>

    <div style="text-align: center; margin-top: 2em; padding-top: 1em; border-top: 1px solid #dee2e6; clear: both;">
        <p class="text-muted" style="font-size: 8px;">
            © 2025 BBMRI-ERIC - Biobanking and BioMolecular resources Research Infrastructure - European Research Infrastructure Consortium<br />
            Court of Justice of the European Union<br />
            This document was generated automatically by the BBMRI-ERIC Negotiator platform on <span th:text="${now}">August 25, 2025</span>
        </p>
    </div>
</div>

<!-- APPENDICES -->
<div th:if="${includeAttachments}">
<div class="page-break"></div>
<h1>Appendices</h1>
<div class="section">
    <div class="placeholder-box">
        <p><strong>Supporting documentation may include:</strong></p>
        <p>Detailed technical specifications, research protocol and methodology, data management plans, quality assurance procedures, and contact information for all parties.</p>
        <p><em>Additional documents and references as applicable</em></p>
    </div>
</div>
</div>

</body>
</html>
